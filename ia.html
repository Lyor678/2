<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FlixAI</title>
  <style>
    :root {font-family: Inter, system-ui, sans-serif;}
    body {margin:0;padding:0;background:linear-gradient(180deg,#0f172a,#1e293b);color:#f1f5f9;min-height:100vh;}

    header {text-align:center;padding:24px 16px;background:#0f172a;box-shadow:0 4px 10px rgba(0,0,0,0.6);}
    h1 {margin:0;font-size:36px;font-weight:700;color:#38bdf8;letter-spacing:1px;}

    .categories {display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin:20px auto;max-width:1000px;}
    .cat-btn {background:#1e293b;border:1px solid #334155;padding:8px 14px;border-radius:30px;font-size:14px;cursor:pointer;transition:all .3s ease;}
    .cat-btn:hover {background:#334155;}
    .cat-btn.active {background:#38bdf8;color:#0f172a;font-weight:600;}

    .grid {display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:24px;margin:30px auto;max-width:1400px;padding:0 16px;}
    .card {background:#1e293b;border-radius:16px;box-shadow:0 6px 18px rgba(0,0,0,0.6);overflow:hidden;cursor:pointer;transition:transform .3s ease, box-shadow .3s ease;display:flex;flex-direction:column;}
    .card:hover {transform:translateY(-8px) scale(1.03);box-shadow:0 12px 28px rgba(0,0,0,0.8)}

    .card-header {padding:20px;border-bottom:1px solid #334155;background:linear-gradient(135deg,#0f172a,#1e293b)}
    .card-title {font-size:20px;font-weight:600;color:#f8fafc;margin:0}
    .card-meta {font-size:13px;color:#94a3b8;margin-top:6px}

    .card-body {padding:18px;font-size:14px;color:#e2e8f0;display:none;animation:fadeIn .4s ease}
    .card-tags {display:flex;flex-wrap:wrap;gap:6px;padding:12px 18px;}
    .tag {background:#334155;color:#f1f5f9;font-size:12px;padding:4px 10px;border-radius:12px;cursor:pointer;transition:all .3s ease;}
    .tag:hover {background:#38bdf8;color:#0f172a;}

    .card-footer {padding:14px 18px;background:#0f172a;font-size:14px;color:#38bdf8;text-decoration:none;transition:color .3s}
    .card-footer:hover {color:#0ea5e9}

    footer {margin:40px 0;color:#94a3b8;font-size:13px;text-align:center}

    @keyframes fadeIn {from {opacity:0;transform:translateY(10px)}to {opacity:1;transform:translateY(0)}}
  </style>
</head>
<body>
  <header>
    <h1>FlixAI</h1>
    <div id="categories" class="categories"></div>
  </header>

  <main>
    <div id="grid" class="grid"></div>
  </main>

  <footer>
    <div>FlixAI — Explorez toutes les IA par catégories ✨</div>
  </footer>

  <script>
    const grid = document.getElementById('grid');
    const categoriesDiv = document.getElementById('categories');
    const keywords = ["ia","business","chatbot","texte","audio","vidéo","3d","photo","marketing","éducation","santé","finance","musique","traduction","data","design","image","voix","code"];

    let allData = [];
    let activeCategory = 'Tous';

    // Chargement automatique du fichier data.json
    window.addEventListener('DOMContentLoaded', async () => {
      try {
        const res = await fetch('data.json');
        if (!res.ok) throw new Error('Impossible de charger data.json. Code: ' + res.status);
        const data = await res.json();
        allData = Array.isArray(data) ? data : [data];
        renderCategories();
        showCards(allData);
      } catch (err) {
        showError(err);
      }
    });

    function renderCategories(){
      categoriesDiv.innerHTML = '';
      const allBtn = createCategoryButton('Tous');
      allBtn.classList.add('active');
      categoriesDiv.appendChild(allBtn);

      keywords.forEach(k => {
        if (allData.some(item => (item.description||'').toLowerCase().includes(k))) {
          categoriesDiv.appendChild(createCategoryButton(k));
        }
      });
    }

    function createCategoryButton(name){
      const btn = document.createElement('button');
      btn.className = 'cat-btn';
      btn.textContent = name;
      btn.addEventListener('click', () => {
        document.querySelectorAll('.cat-btn').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        activeCategory = name;
        filterAndRender();
      });
      return btn;
    }

    function filterAndRender(){
      let filtered = [...allData];
      if (activeCategory !== 'Tous'){
        filtered = filtered.filter(item => (item.description||'').toLowerCase().includes(activeCategory.toLowerCase()));
      }
      showCards(filtered);
    }

    function showError(err){
      grid.innerHTML = `<div style="color:#f87171;font-weight:700">Erreur: ${escapeHtml(err.message || err)}</div>`;
    }

    function showCards(data){
      grid.innerHTML = '';
      data.forEach(item => {
        const card = document.createElement('div');
        card.className = 'card';

        const header = document.createElement('div');
        header.className = 'card-header';
        header.innerHTML = `<h3 class="card-title">${escapeHtml(item.handle || 'Sans nom')}</h3>
                            <div class="card-meta">ID: ${escapeHtml(item.id || '?')}</div>`;

        const body = document.createElement('div');
        body.className = 'card-body';
        body.textContent = item.description || '(pas de description)';

        const tagsDiv = document.createElement('div');
        tagsDiv.className = 'card-tags';
        keywords.forEach(k => {
          if ((item.description||'').toLowerCase().includes(k)){
            const tag = document.createElement('span');
            tag.className = 'tag';
            tag.textContent = k;
            tag.addEventListener('click', e => {
              e.stopPropagation();
              document.querySelectorAll('.cat-btn').forEach(b=>b.classList.remove('active'));
              activeCategory = k;
              filterAndRender();
            });
            tagsDiv.appendChild(tag);
          }
        });

        const footer = document.createElement('a');
        footer.className = 'card-footer';
        footer.href = item.website || '#';
        footer.target = '_blank';
        footer.rel = 'noopener noreferrer';
        footer.textContent = item.website || 'Aucun site';

        card.appendChild(header);
        card.appendChild(body);
        card.appendChild(tagsDiv);
        card.appendChild(footer);

        card.addEventListener('click', () => {
          const isVisible = body.style.display === 'block';
          body.style.display = isVisible ? 'none' : 'block';
        });

        grid.appendChild(card);
      });
    }

    function escapeHtml(s){
      return String(s)
        .replace(/&/g,'&amp;')
        .replace(/</g,'&lt;')
        .replace(/>/g,'&gt;')
        .replace(/"/g,'&quot;');
    }
  </script>
</body>
</html>
